<div class="panel-footer clearfix">
  <!-- <label for="search">Search:</label> -->
  <input ng-model="q" id="search" class="form-control" placeholder="Filter text">
</div>

<div class="panel-body">

  <div class="row clearfix">

    <!-- hack fix: https://github.com/michaelbromley/angularUtils/issues/157 -->
    <div ng-switch on="vm.asyncPagination">
      <!-- Server side pagination -->
      <div ng-switch-when="true" class="flexcontainer">

        <div class="px-card"
             dir-paginate="record in vm.data | filter:q | itemsPerPage: vm.options.paginationPageSize"
             total-items="vm.options.totalItems"
             current-page="vm.options.paginationCurrentPage"
             pagination-id="vm.options.paginationId">

          <ng-include src="'pxcards-layout'"></ng-include>

        </div>

      </div>
      <!-- Client side pagination -->
      <div ng-switch-default class="flexcontainer">

        <div class="px-card"
             dir-paginate="record in vm.data | filter:q | itemsPerPage: vm.options.paginationPageSize"
             current-page="vm.options.paginationCurrentPage"
             pagination-id="vm.options.paginationId">

          <ng-include src="'pxcards-layout'"></ng-include>

        </div>

      </div>
    </div>

  </div>

</div>

<div class="panel-footer">

  <px-pagination
    options="vm.options"
    ng-attr-on-pagination-change="vm.paginationChangeHandler({newPage: newPage, newPageSize: newPageSize})">
  </px-pagination>

</div>

<div class="panel-footer" ng-if="vm.mode == 'browse'">
  <div class="pull-left">
    {{vm.selectedRecords.length}} record(s) selected
  </div>
  <div class="btn-toolbar">
    <div class="pull-right">
      <div class="btn-group btn-group-md">
        <button class="btn btn-primary" type="submit"
          ng-click="vm.nextHandler({selected: vm.selectedRecords})"
          ng-disabled="!vm.selectedRecords.length">
          <em class="glyphicon glyphicon-arrow-right"></em>
          Edit <!-- ToDo: PanaxDB Routes -->
        </button>
      </div>
    </div>
  </div>
</div>


<script type="text/ng-template" id="pxcards-layout">
<div class="panel" ng-class="(vm.selectedRecords.indexOf(record)>=0) ? 'panel-primary' : 'panel-default'">
  <div class="panel-heading clearfix">
    <h3 class="panel-title pull-left">
    {{ record[vm.catalog.customAttrs.titleField] || '&nbsp;'}}
    </h3>
    <div class="btn-group btn-group-xs pull-right">
      <button class="btn" type="submit"
              ng-class="{
                'btn-primary':(vm.mode === 'edit'),
                'btn-default':(vm.mode !== 'edit')
              }"
              ng-click="vm.onClick(record)">
        {{vm.mode === 'edit' ? 'Edit' : ''}}
        {{vm.mode === 'readonly' ? 'View' : ''}}
        {{vm.mode === 'browse' ? '' : ''}}
        <em ng-if="vm.mode === 'browse' && vm.selectedRecords.indexOf(record)==-1" class="glyphicon glyphicon-ok"></em>
        <em ng-if="vm.mode === 'browse' && vm.selectedRecords.indexOf(record)>=0" class="glyphicon glyphicon-remove"></em>
      </button>
    </div>
  </div>
  <div class="list-group">
    <div class="list-group-item">
      <img ng-src="{{ record[vm.catalog.customAttrs.iconField] ? '/upload/' + record[vm.catalog.customAttrs.iconField] : '/images/noimg.png' }}"
           class="px-card-img img-rounded pull-left">
      <label>
      {{ vm.catalog.customAttrs.descField1 || '&nbsp;' }}
      </label>
      <h5 class="list-group-item-heading">
      {{ record[vm.catalog.customAttrs.descField1] || '&nbsp;' }}
      </h5>
      <label>
      {{ vm.catalog.customAttrs.descField2 || '&nbsp;' }}
      </label>
      <h5 class="list-group-item-heading">
      {{ record[vm.catalog.customAttrs.descField2]  || '&nbsp;' }}
      </h5>
    </div>
  </div>
  <!-- <div class="panel-footer clearfix">
  </div> -->
</div>
</script>
