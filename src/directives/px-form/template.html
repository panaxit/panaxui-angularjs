<div class="panel-body">
  <!-- hack fix: https://github.com/michaelbromley/angularUtils/issues/157 -->
  <div ng-switch on="vm.options.asyncPagination">
    <!-- Server side pagination (with total-items)-->
    <div ng-switch-when="true">

      <div dir-paginate="record in vm.data | itemsPerPage: vm.pagination_options.paginationPageSize"
           total-items="vm.pagination_options.totalItems"
           current-page="vm.pagination_options.paginationCurrentPage"
           pagination-id="vm.pagination_options.paginationId">

        <ng-include src="'pxform-layout'" class="pxrecord"></ng-include>

      </div>

    </div>
    <!-- Client side pagination (without total-items)-->
    <div ng-switch-default>

      <div dir-paginate="record in vm.data | itemsPerPage: vm.pagination_options.paginationPageSize"
           current-page="vm.pagination_options.paginationCurrentPage"
           pagination-id="vm.pagination_options.paginationId">

        <ng-include src="'pxform-layout'"></ng-include>

      </div>

    </div>
  </div>
</div>

<div class="panel-footer" ng-if="vm.options.showPaginationRow">

  <px-pagination
    options="vm.pagination_options"
    ng-attr-on-pagination-change="vm.paginationChangeHandler({newPage: newPage, newPageSize: newPageSize})">
  </px-pagination>

</div>

<script type="text/ng-template" id="pxform-layout">

  <formly-form model="record"
               fields="vm.fields[$index]"
               ng-attr-form="vm.form">
  </formly-form>

</script>
